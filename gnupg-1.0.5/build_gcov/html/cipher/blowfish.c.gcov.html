<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>LCOV - coverage.info - cipher/blowfish.c</title>
  <link rel="stylesheet" type="text/css" href="../gcov.css">
</head>

<body>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="title">LCOV - code coverage report</td></tr>
    <tr><td class="ruler"><img src="../glass.png" width=3 height=3 alt=""></td></tr>

    <tr>
      <td width="100%">
        <table cellpadding=1 border=0 width="100%">
          <tr>
            <td width="10%" class="headerItem">Current view:</td>
            <td width="35%" class="headerValue"><a href="../index.html">top level</a> - <a href="index.html">cipher</a> - blowfish.c<span style="font-size: 80%;"> (source / <a href="blowfish.c.func.html">functions</a>)</span></td>
            <td width="5%"></td>
            <td width="15%"></td>
            <td width="10%" class="headerCovTableHead">Hit</td>
            <td width="10%" class="headerCovTableHead">Total</td>
            <td width="15%" class="headerCovTableHead">Coverage</td>
          </tr>
          <tr>
            <td class="headerItem">Test:</td>
            <td class="headerValue">coverage.info</td>
            <td></td>
            <td class="headerItem">Lines:</td>
            <td class="headerCovTableEntry">0</td>
            <td class="headerCovTableEntry">184</td>
            <td class="headerCovTableEntryLo">0.0 %</td>
          </tr>
          <tr>
            <td class="headerItem">Date:</td>
            <td class="headerValue">2012-11-04</td>
            <td></td>
            <td class="headerItem">Functions:</td>
            <td class="headerCovTableEntry">0</td>
            <td class="headerCovTableEntry">11</td>
            <td class="headerCovTableEntryLo">0.0 %</td>
          </tr>
          <tr><td><img src="../glass.png" width=3 height=3 alt=""></td></tr>
        </table>
      </td>
    </tr>

    <tr><td class="ruler"><img src="../glass.png" width=3 height=3 alt=""></td></tr>
  </table>

  <table cellpadding=0 cellspacing=0 border=0>
    <tr>
      <td><br></td>
    </tr>
    <tr>
      <td>
<pre class="sourceHeading">          Line data    Source code</pre>
<pre class="source">
<a name="1"><span class="lineNum">       1 </span>            : /* blowfish.c  -  Blowfish encryption</a>
<span class="lineNum">       2 </span>            :  *      Copyright (C) 1998, 1999, 2000, 2001 Free Software Foundation, Inc.
<span class="lineNum">       3 </span>            :  *
<span class="lineNum">       4 </span>            :  * This file is part of GnuPG.
<span class="lineNum">       5 </span>            :  *
<span class="lineNum">       6 </span>            :  * GnuPG is free software; you can redistribute it and/or modify
<span class="lineNum">       7 </span>            :  * it under the terms of the GNU General Public License as published by
<span class="lineNum">       8 </span>            :  * the Free Software Foundation; either version 2 of the License, or
<span class="lineNum">       9 </span>            :  * (at your option) any later version.
<span class="lineNum">      10 </span>            :  *
<span class="lineNum">      11 </span>            :  * GnuPG is distributed in the hope that it will be useful,
<span class="lineNum">      12 </span>            :  * but WITHOUT ANY WARRANTY; without even the implied warranty of
<span class="lineNum">      13 </span>            :  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
<span class="lineNum">      14 </span>            :  * GNU General Public License for more details.
<span class="lineNum">      15 </span>            :  *
<span class="lineNum">      16 </span>            :  * You should have received a copy of the GNU General Public License
<span class="lineNum">      17 </span>            :  * along with this program; if not, write to the Free Software
<span class="lineNum">      18 </span>            :  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA
<span class="lineNum">      19 </span>            :  *
<span class="lineNum">      20 </span>            :  * For a description of the algorithm, see:
<span class="lineNum">      21 </span>            :  *   Bruce Schneier: Applied Cryptography. John Wiley &amp; Sons, 1996.
<span class="lineNum">      22 </span>            :  *   ISBN 0-471-11709-9. Pages 336 ff.
<span class="lineNum">      23 </span>            :  */
<span class="lineNum">      24 </span>            : 
<span class="lineNum">      25 </span>            : /* Test values:
<span class="lineNum">      26 </span>            :  * key    &quot;abcdefghijklmnopqrstuvwxyz&quot;;
<span class="lineNum">      27 </span>            :  * plain  &quot;BLOWFISH&quot;
<span class="lineNum">      28 </span>            :  * cipher 32 4E D0 FE F4 13 A2 03
<span class="lineNum">      29 </span>            :  *
<span class="lineNum">      30 </span>            :  */
<span class="lineNum">      31 </span>            : 
<span class="lineNum">      32 </span>            : #include &lt;config.h&gt;
<span class="lineNum">      33 </span>            : #include &lt;stdio.h&gt;
<span class="lineNum">      34 </span>            : #include &lt;stdlib.h&gt;
<span class="lineNum">      35 </span>            : #include &lt;string.h&gt;
<span class="lineNum">      36 </span>            : #include &lt;assert.h&gt;
<span class="lineNum">      37 </span>            : #include &quot;types.h&quot;
<span class="lineNum">      38 </span>            : #include &quot;errors.h&quot;
<span class="lineNum">      39 </span>            : #include &quot;blowfish.h&quot;
<span class="lineNum">      40 </span>            : #include &quot;dynload.h&quot;
<span class="lineNum">      41 </span>            : 
<span class="lineNum">      42 </span>            : 
<span class="lineNum">      43 </span>            : 
<span class="lineNum">      44 </span>            : #define CIPHER_ALGO_BLOWFISH     4  /* blowfish 128 bit key */
<span class="lineNum">      45 </span>            : 
<span class="lineNum">      46 </span>            : #define BLOWFISH_BLOCKSIZE 8
<span class="lineNum">      47 </span>            : #define BLOWFISH_ROUNDS 16
<span class="lineNum">      48 </span>            : 
<span class="lineNum">      49 </span>            : typedef struct {
<span class="lineNum">      50 </span>            :     u32 s0[256];
<span class="lineNum">      51 </span>            :     u32 s1[256];
<span class="lineNum">      52 </span>            :     u32 s2[256];
<span class="lineNum">      53 </span>            :     u32 s3[256];
<span class="lineNum">      54 </span>            :     u32 p[BLOWFISH_ROUNDS+2];
<span class="lineNum">      55 </span>            : } BLOWFISH_context;
<span class="lineNum">      56 </span>            : 
<span class="lineNum">      57 </span>            : static int  bf_setkey( BLOWFISH_context *c, byte *key, unsigned keylen );
<span class="lineNum">      58 </span>            : static void encrypt_block( BLOWFISH_context *bc, byte *outbuf, byte *inbuf );
<span class="lineNum">      59 </span>            : static void decrypt_block( BLOWFISH_context *bc, byte *outbuf, byte *inbuf );
<span class="lineNum">      60 </span>            : 
<span class="lineNum">      61 </span>            : 
<span class="lineNum">      62 </span>            : /* precomputed S boxes */
<span class="lineNum">      63 </span>            : static const u32 ks0[256] = {
<span class="lineNum">      64 </span>            :     0xD1310BA6,0x98DFB5AC,0x2FFD72DB,0xD01ADFB7,0xB8E1AFED,0x6A267E96,
<span class="lineNum">      65 </span>            :     0xBA7C9045,0xF12C7F99,0x24A19947,0xB3916CF7,0x0801F2E2,0x858EFC16,
<span class="lineNum">      66 </span>            :     0x636920D8,0x71574E69,0xA458FEA3,0xF4933D7E,0x0D95748F,0x728EB658,
<span class="lineNum">      67 </span>            :     0x718BCD58,0x82154AEE,0x7B54A41D,0xC25A59B5,0x9C30D539,0x2AF26013,
<span class="lineNum">      68 </span>            :     0xC5D1B023,0x286085F0,0xCA417918,0xB8DB38EF,0x8E79DCB0,0x603A180E,
<span class="lineNum">      69 </span>            :     0x6C9E0E8B,0xB01E8A3E,0xD71577C1,0xBD314B27,0x78AF2FDA,0x55605C60,
<span class="lineNum">      70 </span>            :     0xE65525F3,0xAA55AB94,0x57489862,0x63E81440,0x55CA396A,0x2AAB10B6,
<span class="lineNum">      71 </span>            :     0xB4CC5C34,0x1141E8CE,0xA15486AF,0x7C72E993,0xB3EE1411,0x636FBC2A,
<span class="lineNum">      72 </span>            :     0x2BA9C55D,0x741831F6,0xCE5C3E16,0x9B87931E,0xAFD6BA33,0x6C24CF5C,
<span class="lineNum">      73 </span>            :     0x7A325381,0x28958677,0x3B8F4898,0x6B4BB9AF,0xC4BFE81B,0x66282193,
<span class="lineNum">      74 </span>            :     0x61D809CC,0xFB21A991,0x487CAC60,0x5DEC8032,0xEF845D5D,0xE98575B1,
<span class="lineNum">      75 </span>            :     0xDC262302,0xEB651B88,0x23893E81,0xD396ACC5,0x0F6D6FF3,0x83F44239,
<span class="lineNum">      76 </span>            :     0x2E0B4482,0xA4842004,0x69C8F04A,0x9E1F9B5E,0x21C66842,0xF6E96C9A,
<span class="lineNum">      77 </span>            :     0x670C9C61,0xABD388F0,0x6A51A0D2,0xD8542F68,0x960FA728,0xAB5133A3,
<span class="lineNum">      78 </span>            :     0x6EEF0B6C,0x137A3BE4,0xBA3BF050,0x7EFB2A98,0xA1F1651D,0x39AF0176,
<span class="lineNum">      79 </span>            :     0x66CA593E,0x82430E88,0x8CEE8619,0x456F9FB4,0x7D84A5C3,0x3B8B5EBE,
<span class="lineNum">      80 </span>            :     0xE06F75D8,0x85C12073,0x401A449F,0x56C16AA6,0x4ED3AA62,0x363F7706,
<span class="lineNum">      81 </span>            :     0x1BFEDF72,0x429B023D,0x37D0D724,0xD00A1248,0xDB0FEAD3,0x49F1C09B,
<span class="lineNum">      82 </span>            :     0x075372C9,0x80991B7B,0x25D479D8,0xF6E8DEF7,0xE3FE501A,0xB6794C3B,
<span class="lineNum">      83 </span>            :     0x976CE0BD,0x04C006BA,0xC1A94FB6,0x409F60C4,0x5E5C9EC2,0x196A2463,
<span class="lineNum">      84 </span>            :     0x68FB6FAF,0x3E6C53B5,0x1339B2EB,0x3B52EC6F,0x6DFC511F,0x9B30952C,
<span class="lineNum">      85 </span>            :     0xCC814544,0xAF5EBD09,0xBEE3D004,0xDE334AFD,0x660F2807,0x192E4BB3,
<span class="lineNum">      86 </span>            :     0xC0CBA857,0x45C8740F,0xD20B5F39,0xB9D3FBDB,0x5579C0BD,0x1A60320A,
<span class="lineNum">      87 </span>            :     0xD6A100C6,0x402C7279,0x679F25FE,0xFB1FA3CC,0x8EA5E9F8,0xDB3222F8,
<span class="lineNum">      88 </span>            :     0x3C7516DF,0xFD616B15,0x2F501EC8,0xAD0552AB,0x323DB5FA,0xFD238760,
<span class="lineNum">      89 </span>            :     0x53317B48,0x3E00DF82,0x9E5C57BB,0xCA6F8CA0,0x1A87562E,0xDF1769DB,
<span class="lineNum">      90 </span>            :     0xD542A8F6,0x287EFFC3,0xAC6732C6,0x8C4F5573,0x695B27B0,0xBBCA58C8,
<span class="lineNum">      91 </span>            :     0xE1FFA35D,0xB8F011A0,0x10FA3D98,0xFD2183B8,0x4AFCB56C,0x2DD1D35B,
<span class="lineNum">      92 </span>            :     0x9A53E479,0xB6F84565,0xD28E49BC,0x4BFB9790,0xE1DDF2DA,0xA4CB7E33,
<span class="lineNum">      93 </span>            :     0x62FB1341,0xCEE4C6E8,0xEF20CADA,0x36774C01,0xD07E9EFE,0x2BF11FB4,
<span class="lineNum">      94 </span>            :     0x95DBDA4D,0xAE909198,0xEAAD8E71,0x6B93D5A0,0xD08ED1D0,0xAFC725E0,
<span class="lineNum">      95 </span>            :     0x8E3C5B2F,0x8E7594B7,0x8FF6E2FB,0xF2122B64,0x8888B812,0x900DF01C,
<span class="lineNum">      96 </span>            :     0x4FAD5EA0,0x688FC31C,0xD1CFF191,0xB3A8C1AD,0x2F2F2218,0xBE0E1777,
<span class="lineNum">      97 </span>            :     0xEA752DFE,0x8B021FA1,0xE5A0CC0F,0xB56F74E8,0x18ACF3D6,0xCE89E299,
<span class="lineNum">      98 </span>            :     0xB4A84FE0,0xFD13E0B7,0x7CC43B81,0xD2ADA8D9,0x165FA266,0x80957705,
<span class="lineNum">      99 </span>            :     0x93CC7314,0x211A1477,0xE6AD2065,0x77B5FA86,0xC75442F5,0xFB9D35CF,
<span class="lineNum">     100 </span>            :     0xEBCDAF0C,0x7B3E89A0,0xD6411BD3,0xAE1E7E49,0x00250E2D,0x2071B35E,
<span class="lineNum">     101 </span>            :     0x226800BB,0x57B8E0AF,0x2464369B,0xF009B91E,0x5563911D,0x59DFA6AA,
<span class="lineNum">     102 </span>            :     0x78C14389,0xD95A537F,0x207D5BA2,0x02E5B9C5,0x83260376,0x6295CFA9,
<span class="lineNum">     103 </span>            :     0x11C81968,0x4E734A41,0xB3472DCA,0x7B14A94A,0x1B510052,0x9A532915,
<span class="lineNum">     104 </span>            :     0xD60F573F,0xBC9BC6E4,0x2B60A476,0x81E67400,0x08BA6FB5,0x571BE91F,
<span class="lineNum">     105 </span>            :     0xF296EC6B,0x2A0DD915,0xB6636521,0xE7B9F9B6,0xFF34052E,0xC5855664,
<span class="lineNum">     106 </span>            :     0x53B02D5D,0xA99F8FA1,0x08BA4799,0x6E85076A };
<span class="lineNum">     107 </span>            : 
<span class="lineNum">     108 </span>            : static const u32 ks1[256] = {
<span class="lineNum">     109 </span>            :     0x4B7A70E9,0xB5B32944,0xDB75092E,0xC4192623,0xAD6EA6B0,0x49A7DF7D,
<span class="lineNum">     110 </span>            :     0x9CEE60B8,0x8FEDB266,0xECAA8C71,0x699A17FF,0x5664526C,0xC2B19EE1,
<span class="lineNum">     111 </span>            :     0x193602A5,0x75094C29,0xA0591340,0xE4183A3E,0x3F54989A,0x5B429D65,
<span class="lineNum">     112 </span>            :     0x6B8FE4D6,0x99F73FD6,0xA1D29C07,0xEFE830F5,0x4D2D38E6,0xF0255DC1,
<span class="lineNum">     113 </span>            :     0x4CDD2086,0x8470EB26,0x6382E9C6,0x021ECC5E,0x09686B3F,0x3EBAEFC9,
<span class="lineNum">     114 </span>            :     0x3C971814,0x6B6A70A1,0x687F3584,0x52A0E286,0xB79C5305,0xAA500737,
<span class="lineNum">     115 </span>            :     0x3E07841C,0x7FDEAE5C,0x8E7D44EC,0x5716F2B8,0xB03ADA37,0xF0500C0D,
<span class="lineNum">     116 </span>            :     0xF01C1F04,0x0200B3FF,0xAE0CF51A,0x3CB574B2,0x25837A58,0xDC0921BD,
<span class="lineNum">     117 </span>            :     0xD19113F9,0x7CA92FF6,0x94324773,0x22F54701,0x3AE5E581,0x37C2DADC,
<span class="lineNum">     118 </span>            :     0xC8B57634,0x9AF3DDA7,0xA9446146,0x0FD0030E,0xECC8C73E,0xA4751E41,
<span class="lineNum">     119 </span>            :     0xE238CD99,0x3BEA0E2F,0x3280BBA1,0x183EB331,0x4E548B38,0x4F6DB908,
<span class="lineNum">     120 </span>            :     0x6F420D03,0xF60A04BF,0x2CB81290,0x24977C79,0x5679B072,0xBCAF89AF,
<span class="lineNum">     121 </span>            :     0xDE9A771F,0xD9930810,0xB38BAE12,0xDCCF3F2E,0x5512721F,0x2E6B7124,
<span class="lineNum">     122 </span>            :     0x501ADDE6,0x9F84CD87,0x7A584718,0x7408DA17,0xBC9F9ABC,0xE94B7D8C,
<span class="lineNum">     123 </span>            :     0xEC7AEC3A,0xDB851DFA,0x63094366,0xC464C3D2,0xEF1C1847,0x3215D908,
<span class="lineNum">     124 </span>            :     0xDD433B37,0x24C2BA16,0x12A14D43,0x2A65C451,0x50940002,0x133AE4DD,
<span class="lineNum">     125 </span>            :     0x71DFF89E,0x10314E55,0x81AC77D6,0x5F11199B,0x043556F1,0xD7A3C76B,
<span class="lineNum">     126 </span>            :     0x3C11183B,0x5924A509,0xF28FE6ED,0x97F1FBFA,0x9EBABF2C,0x1E153C6E,
<span class="lineNum">     127 </span>            :     0x86E34570,0xEAE96FB1,0x860E5E0A,0x5A3E2AB3,0x771FE71C,0x4E3D06FA,
<span class="lineNum">     128 </span>            :     0x2965DCB9,0x99E71D0F,0x803E89D6,0x5266C825,0x2E4CC978,0x9C10B36A,
<span class="lineNum">     129 </span>            :     0xC6150EBA,0x94E2EA78,0xA5FC3C53,0x1E0A2DF4,0xF2F74EA7,0x361D2B3D,
<span class="lineNum">     130 </span>            :     0x1939260F,0x19C27960,0x5223A708,0xF71312B6,0xEBADFE6E,0xEAC31F66,
<span class="lineNum">     131 </span>            :     0xE3BC4595,0xA67BC883,0xB17F37D1,0x018CFF28,0xC332DDEF,0xBE6C5AA5,
<span class="lineNum">     132 </span>            :     0x65582185,0x68AB9802,0xEECEA50F,0xDB2F953B,0x2AEF7DAD,0x5B6E2F84,
<span class="lineNum">     133 </span>            :     0x1521B628,0x29076170,0xECDD4775,0x619F1510,0x13CCA830,0xEB61BD96,
<span class="lineNum">     134 </span>            :     0x0334FE1E,0xAA0363CF,0xB5735C90,0x4C70A239,0xD59E9E0B,0xCBAADE14,
<span class="lineNum">     135 </span>            :     0xEECC86BC,0x60622CA7,0x9CAB5CAB,0xB2F3846E,0x648B1EAF,0x19BDF0CA,
<span class="lineNum">     136 </span>            :     0xA02369B9,0x655ABB50,0x40685A32,0x3C2AB4B3,0x319EE9D5,0xC021B8F7,
<span class="lineNum">     137 </span>            :     0x9B540B19,0x875FA099,0x95F7997E,0x623D7DA8,0xF837889A,0x97E32D77,
<span class="lineNum">     138 </span>            :     0x11ED935F,0x16681281,0x0E358829,0xC7E61FD6,0x96DEDFA1,0x7858BA99,
<span class="lineNum">     139 </span>            :     0x57F584A5,0x1B227263,0x9B83C3FF,0x1AC24696,0xCDB30AEB,0x532E3054,
<span class="lineNum">     140 </span>            :     0x8FD948E4,0x6DBC3128,0x58EBF2EF,0x34C6FFEA,0xFE28ED61,0xEE7C3C73,
<span class="lineNum">     141 </span>            :     0x5D4A14D9,0xE864B7E3,0x42105D14,0x203E13E0,0x45EEE2B6,0xA3AAABEA,
<span class="lineNum">     142 </span>            :     0xDB6C4F15,0xFACB4FD0,0xC742F442,0xEF6ABBB5,0x654F3B1D,0x41CD2105,
<span class="lineNum">     143 </span>            :     0xD81E799E,0x86854DC7,0xE44B476A,0x3D816250,0xCF62A1F2,0x5B8D2646,
<span class="lineNum">     144 </span>            :     0xFC8883A0,0xC1C7B6A3,0x7F1524C3,0x69CB7492,0x47848A0B,0x5692B285,
<span class="lineNum">     145 </span>            :     0x095BBF00,0xAD19489D,0x1462B174,0x23820E00,0x58428D2A,0x0C55F5EA,
<span class="lineNum">     146 </span>            :     0x1DADF43E,0x233F7061,0x3372F092,0x8D937E41,0xD65FECF1,0x6C223BDB,
<span class="lineNum">     147 </span>            :     0x7CDE3759,0xCBEE7460,0x4085F2A7,0xCE77326E,0xA6078084,0x19F8509E,
<span class="lineNum">     148 </span>            :     0xE8EFD855,0x61D99735,0xA969A7AA,0xC50C06C2,0x5A04ABFC,0x800BCADC,
<span class="lineNum">     149 </span>            :     0x9E447A2E,0xC3453484,0xFDD56705,0x0E1E9EC9,0xDB73DBD3,0x105588CD,
<span class="lineNum">     150 </span>            :     0x675FDA79,0xE3674340,0xC5C43465,0x713E38D8,0x3D28F89E,0xF16DFF20,
<span class="lineNum">     151 </span>            :     0x153E21E7,0x8FB03D4A,0xE6E39F2B,0xDB83ADF7 };
<span class="lineNum">     152 </span>            : 
<span class="lineNum">     153 </span>            : static const u32 ks2[256] = {
<span class="lineNum">     154 </span>            :     0xE93D5A68,0x948140F7,0xF64C261C,0x94692934,0x411520F7,0x7602D4F7,
<span class="lineNum">     155 </span>            :     0xBCF46B2E,0xD4A20068,0xD4082471,0x3320F46A,0x43B7D4B7,0x500061AF,
<span class="lineNum">     156 </span>            :     0x1E39F62E,0x97244546,0x14214F74,0xBF8B8840,0x4D95FC1D,0x96B591AF,
<span class="lineNum">     157 </span>            :     0x70F4DDD3,0x66A02F45,0xBFBC09EC,0x03BD9785,0x7FAC6DD0,0x31CB8504,
<span class="lineNum">     158 </span>            :     0x96EB27B3,0x55FD3941,0xDA2547E6,0xABCA0A9A,0x28507825,0x530429F4,
<span class="lineNum">     159 </span>            :     0x0A2C86DA,0xE9B66DFB,0x68DC1462,0xD7486900,0x680EC0A4,0x27A18DEE,
<span class="lineNum">     160 </span>            :     0x4F3FFEA2,0xE887AD8C,0xB58CE006,0x7AF4D6B6,0xAACE1E7C,0xD3375FEC,
<span class="lineNum">     161 </span>            :     0xCE78A399,0x406B2A42,0x20FE9E35,0xD9F385B9,0xEE39D7AB,0x3B124E8B,
<span class="lineNum">     162 </span>            :     0x1DC9FAF7,0x4B6D1856,0x26A36631,0xEAE397B2,0x3A6EFA74,0xDD5B4332,
<span class="lineNum">     163 </span>            :     0x6841E7F7,0xCA7820FB,0xFB0AF54E,0xD8FEB397,0x454056AC,0xBA489527,
<span class="lineNum">     164 </span>            :     0x55533A3A,0x20838D87,0xFE6BA9B7,0xD096954B,0x55A867BC,0xA1159A58,
<span class="lineNum">     165 </span>            :     0xCCA92963,0x99E1DB33,0xA62A4A56,0x3F3125F9,0x5EF47E1C,0x9029317C,
<span class="lineNum">     166 </span>            :     0xFDF8E802,0x04272F70,0x80BB155C,0x05282CE3,0x95C11548,0xE4C66D22,
<span class="lineNum">     167 </span>            :     0x48C1133F,0xC70F86DC,0x07F9C9EE,0x41041F0F,0x404779A4,0x5D886E17,
<span class="lineNum">     168 </span>            :     0x325F51EB,0xD59BC0D1,0xF2BCC18F,0x41113564,0x257B7834,0x602A9C60,
<span class="lineNum">     169 </span>            :     0xDFF8E8A3,0x1F636C1B,0x0E12B4C2,0x02E1329E,0xAF664FD1,0xCAD18115,
<span class="lineNum">     170 </span>            :     0x6B2395E0,0x333E92E1,0x3B240B62,0xEEBEB922,0x85B2A20E,0xE6BA0D99,
<span class="lineNum">     171 </span>            :     0xDE720C8C,0x2DA2F728,0xD0127845,0x95B794FD,0x647D0862,0xE7CCF5F0,
<span class="lineNum">     172 </span>            :     0x5449A36F,0x877D48FA,0xC39DFD27,0xF33E8D1E,0x0A476341,0x992EFF74,
<span class="lineNum">     173 </span>            :     0x3A6F6EAB,0xF4F8FD37,0xA812DC60,0xA1EBDDF8,0x991BE14C,0xDB6E6B0D,
<span class="lineNum">     174 </span>            :     0xC67B5510,0x6D672C37,0x2765D43B,0xDCD0E804,0xF1290DC7,0xCC00FFA3,
<span class="lineNum">     175 </span>            :     0xB5390F92,0x690FED0B,0x667B9FFB,0xCEDB7D9C,0xA091CF0B,0xD9155EA3,
<span class="lineNum">     176 </span>            :     0xBB132F88,0x515BAD24,0x7B9479BF,0x763BD6EB,0x37392EB3,0xCC115979,
<span class="lineNum">     177 </span>            :     0x8026E297,0xF42E312D,0x6842ADA7,0xC66A2B3B,0x12754CCC,0x782EF11C,
<span class="lineNum">     178 </span>            :     0x6A124237,0xB79251E7,0x06A1BBE6,0x4BFB6350,0x1A6B1018,0x11CAEDFA,
<span class="lineNum">     179 </span>            :     0x3D25BDD8,0xE2E1C3C9,0x44421659,0x0A121386,0xD90CEC6E,0xD5ABEA2A,
<span class="lineNum">     180 </span>            :     0x64AF674E,0xDA86A85F,0xBEBFE988,0x64E4C3FE,0x9DBC8057,0xF0F7C086,
<span class="lineNum">     181 </span>            :     0x60787BF8,0x6003604D,0xD1FD8346,0xF6381FB0,0x7745AE04,0xD736FCCC,
<span class="lineNum">     182 </span>            :     0x83426B33,0xF01EAB71,0xB0804187,0x3C005E5F,0x77A057BE,0xBDE8AE24,
<span class="lineNum">     183 </span>            :     0x55464299,0xBF582E61,0x4E58F48F,0xF2DDFDA2,0xF474EF38,0x8789BDC2,
<span class="lineNum">     184 </span>            :     0x5366F9C3,0xC8B38E74,0xB475F255,0x46FCD9B9,0x7AEB2661,0x8B1DDF84,
<span class="lineNum">     185 </span>            :     0x846A0E79,0x915F95E2,0x466E598E,0x20B45770,0x8CD55591,0xC902DE4C,
<span class="lineNum">     186 </span>            :     0xB90BACE1,0xBB8205D0,0x11A86248,0x7574A99E,0xB77F19B6,0xE0A9DC09,
<span class="lineNum">     187 </span>            :     0x662D09A1,0xC4324633,0xE85A1F02,0x09F0BE8C,0x4A99A025,0x1D6EFE10,
<span class="lineNum">     188 </span>            :     0x1AB93D1D,0x0BA5A4DF,0xA186F20F,0x2868F169,0xDCB7DA83,0x573906FE,
<span class="lineNum">     189 </span>            :     0xA1E2CE9B,0x4FCD7F52,0x50115E01,0xA70683FA,0xA002B5C4,0x0DE6D027,
<span class="lineNum">     190 </span>            :     0x9AF88C27,0x773F8641,0xC3604C06,0x61A806B5,0xF0177A28,0xC0F586E0,
<span class="lineNum">     191 </span>            :     0x006058AA,0x30DC7D62,0x11E69ED7,0x2338EA63,0x53C2DD94,0xC2C21634,
<span class="lineNum">     192 </span>            :     0xBBCBEE56,0x90BCB6DE,0xEBFC7DA1,0xCE591D76,0x6F05E409,0x4B7C0188,
<span class="lineNum">     193 </span>            :     0x39720A3D,0x7C927C24,0x86E3725F,0x724D9DB9,0x1AC15BB4,0xD39EB8FC,
<span class="lineNum">     194 </span>            :     0xED545578,0x08FCA5B5,0xD83D7CD3,0x4DAD0FC4,0x1E50EF5E,0xB161E6F8,
<span class="lineNum">     195 </span>            :     0xA28514D9,0x6C51133C,0x6FD5C7E7,0x56E14EC4,0x362ABFCE,0xDDC6C837,
<span class="lineNum">     196 </span>            :     0xD79A3234,0x92638212,0x670EFA8E,0x406000E0 };
<span class="lineNum">     197 </span>            : 
<span class="lineNum">     198 </span>            : static const u32 ks3[256] = {
<span class="lineNum">     199 </span>            :     0x3A39CE37,0xD3FAF5CF,0xABC27737,0x5AC52D1B,0x5CB0679E,0x4FA33742,
<span class="lineNum">     200 </span>            :     0xD3822740,0x99BC9BBE,0xD5118E9D,0xBF0F7315,0xD62D1C7E,0xC700C47B,
<span class="lineNum">     201 </span>            :     0xB78C1B6B,0x21A19045,0xB26EB1BE,0x6A366EB4,0x5748AB2F,0xBC946E79,
<span class="lineNum">     202 </span>            :     0xC6A376D2,0x6549C2C8,0x530FF8EE,0x468DDE7D,0xD5730A1D,0x4CD04DC6,
<span class="lineNum">     203 </span>            :     0x2939BBDB,0xA9BA4650,0xAC9526E8,0xBE5EE304,0xA1FAD5F0,0x6A2D519A,
<span class="lineNum">     204 </span>            :     0x63EF8CE2,0x9A86EE22,0xC089C2B8,0x43242EF6,0xA51E03AA,0x9CF2D0A4,
<span class="lineNum">     205 </span>            :     0x83C061BA,0x9BE96A4D,0x8FE51550,0xBA645BD6,0x2826A2F9,0xA73A3AE1,
<span class="lineNum">     206 </span>            :     0x4BA99586,0xEF5562E9,0xC72FEFD3,0xF752F7DA,0x3F046F69,0x77FA0A59,
<span class="lineNum">     207 </span>            :     0x80E4A915,0x87B08601,0x9B09E6AD,0x3B3EE593,0xE990FD5A,0x9E34D797,
<span class="lineNum">     208 </span>            :     0x2CF0B7D9,0x022B8B51,0x96D5AC3A,0x017DA67D,0xD1CF3ED6,0x7C7D2D28,
<span class="lineNum">     209 </span>            :     0x1F9F25CF,0xADF2B89B,0x5AD6B472,0x5A88F54C,0xE029AC71,0xE019A5E6,
<span class="lineNum">     210 </span>            :     0x47B0ACFD,0xED93FA9B,0xE8D3C48D,0x283B57CC,0xF8D56629,0x79132E28,
<span class="lineNum">     211 </span>            :     0x785F0191,0xED756055,0xF7960E44,0xE3D35E8C,0x15056DD4,0x88F46DBA,
<span class="lineNum">     212 </span>            :     0x03A16125,0x0564F0BD,0xC3EB9E15,0x3C9057A2,0x97271AEC,0xA93A072A,
<span class="lineNum">     213 </span>            :     0x1B3F6D9B,0x1E6321F5,0xF59C66FB,0x26DCF319,0x7533D928,0xB155FDF5,
<span class="lineNum">     214 </span>            :     0x03563482,0x8ABA3CBB,0x28517711,0xC20AD9F8,0xABCC5167,0xCCAD925F,
<span class="lineNum">     215 </span>            :     0x4DE81751,0x3830DC8E,0x379D5862,0x9320F991,0xEA7A90C2,0xFB3E7BCE,
<span class="lineNum">     216 </span>            :     0x5121CE64,0x774FBE32,0xA8B6E37E,0xC3293D46,0x48DE5369,0x6413E680,
<span class="lineNum">     217 </span>            :     0xA2AE0810,0xDD6DB224,0x69852DFD,0x09072166,0xB39A460A,0x6445C0DD,
<span class="lineNum">     218 </span>            :     0x586CDECF,0x1C20C8AE,0x5BBEF7DD,0x1B588D40,0xCCD2017F,0x6BB4E3BB,
<span class="lineNum">     219 </span>            :     0xDDA26A7E,0x3A59FF45,0x3E350A44,0xBCB4CDD5,0x72EACEA8,0xFA6484BB,
<span class="lineNum">     220 </span>            :     0x8D6612AE,0xBF3C6F47,0xD29BE463,0x542F5D9E,0xAEC2771B,0xF64E6370,
<span class="lineNum">     221 </span>            :     0x740E0D8D,0xE75B1357,0xF8721671,0xAF537D5D,0x4040CB08,0x4EB4E2CC,
<span class="lineNum">     222 </span>            :     0x34D2466A,0x0115AF84,0xE1B00428,0x95983A1D,0x06B89FB4,0xCE6EA048,
<span class="lineNum">     223 </span>            :     0x6F3F3B82,0x3520AB82,0x011A1D4B,0x277227F8,0x611560B1,0xE7933FDC,
<span class="lineNum">     224 </span>            :     0xBB3A792B,0x344525BD,0xA08839E1,0x51CE794B,0x2F32C9B7,0xA01FBAC9,
<span class="lineNum">     225 </span>            :     0xE01CC87E,0xBCC7D1F6,0xCF0111C3,0xA1E8AAC7,0x1A908749,0xD44FBD9A,
<span class="lineNum">     226 </span>            :     0xD0DADECB,0xD50ADA38,0x0339C32A,0xC6913667,0x8DF9317C,0xE0B12B4F,
<span class="lineNum">     227 </span>            :     0xF79E59B7,0x43F5BB3A,0xF2D519FF,0x27D9459C,0xBF97222C,0x15E6FC2A,
<span class="lineNum">     228 </span>            :     0x0F91FC71,0x9B941525,0xFAE59361,0xCEB69CEB,0xC2A86459,0x12BAA8D1,
<span class="lineNum">     229 </span>            :     0xB6C1075E,0xE3056A0C,0x10D25065,0xCB03A442,0xE0EC6E0E,0x1698DB3B,
<span class="lineNum">     230 </span>            :     0x4C98A0BE,0x3278E964,0x9F1F9532,0xE0D392DF,0xD3A0342B,0x8971F21E,
<span class="lineNum">     231 </span>            :     0x1B0A7441,0x4BA3348C,0xC5BE7120,0xC37632D8,0xDF359F8D,0x9B992F2E,
<span class="lineNum">     232 </span>            :     0xE60B6F47,0x0FE3F11D,0xE54CDA54,0x1EDAD891,0xCE6279CF,0xCD3E7E6F,
<span class="lineNum">     233 </span>            :     0x1618B166,0xFD2C1D05,0x848FD2C5,0xF6FB2299,0xF523F357,0xA6327623,
<span class="lineNum">     234 </span>            :     0x93A83531,0x56CCCD02,0xACF08162,0x5A75EBB5,0x6E163697,0x88D273CC,
<span class="lineNum">     235 </span>            :     0xDE966292,0x81B949D0,0x4C50901B,0x71C65614,0xE6C6C7BD,0x327A140A,
<span class="lineNum">     236 </span>            :     0x45E1D006,0xC3F27B9A,0xC9AA53FD,0x62A80F00,0xBB25BFE2,0x35BDD2F6,
<span class="lineNum">     237 </span>            :     0x71126905,0xB2040222,0xB6CBCF7C,0xCD769C2B,0x53113EC0,0x1640E3D3,
<span class="lineNum">     238 </span>            :     0x38ABBD60,0x2547ADF0,0xBA38209C,0xF746CE76,0x77AFA1C5,0x20756060,
<span class="lineNum">     239 </span>            :     0x85CBFE4E,0x8AE88DD8,0x7AAAF9B0,0x4CF9AA7E,0x1948C25C,0x02FB8A8C,
<span class="lineNum">     240 </span>            :     0x01C36AE4,0xD6EBE1F9,0x90D4F869,0xA65CDEA0,0x3F09252D,0xC208E69F,
<span class="lineNum">     241 </span>            :     0xB74E6132,0xCE77E25B,0x578FDFE3,0x3AC372E6 };
<span class="lineNum">     242 </span>            : 
<span class="lineNum">     243 </span>            : static const u32 ps[BLOWFISH_ROUNDS+2] = {
<span class="lineNum">     244 </span>            :     0x243F6A88,0x85A308D3,0x13198A2E,0x03707344,0xA4093822,0x299F31D0,
<span class="lineNum">     245 </span>            :     0x082EFA98,0xEC4E6C89,0x452821E6,0x38D01377,0xBE5466CF,0x34E90C6C,
<span class="lineNum">     246 </span>            :     0xC0AC29B7,0xC97C50DD,0x3F84D5B5,0xB5470917,0x9216D5D9,0x8979FB1B };
<span class="lineNum">     247 </span>            : 
<span class="lineNum">     248 </span>            : 
<span class="lineNum">     249 </span>            : 
<span class="lineNum">     250 </span>            : #if BLOWFISH_ROUNDS != 16
<span class="lineNum">     251 </span>            : static inline u32
<span class="lineNum">     252 </span>            : function_F( BLOWFISH_context *bc, u32 x )
<span class="lineNum">     253 </span>            : {
<span class="lineNum">     254 </span>            :     u16 a, b, c, d;
<span class="lineNum">     255 </span>            : 
<span class="lineNum">     256 </span>            :   #ifdef BIG_ENDIAN_HOST
<span class="lineNum">     257 </span>            :     a = ((byte*)&amp;x)[0];
<span class="lineNum">     258 </span>            :     b = ((byte*)&amp;x)[1];
<span class="lineNum">     259 </span>            :     c = ((byte*)&amp;x)[2];
<span class="lineNum">     260 </span>            :     d = ((byte*)&amp;x)[3];
<span class="lineNum">     261 </span>            :   #else
<span class="lineNum">     262 </span>            :     a = ((byte*)&amp;x)[3];
<span class="lineNum">     263 </span>            :     b = ((byte*)&amp;x)[2];
<span class="lineNum">     264 </span>            :     c = ((byte*)&amp;x)[1];
<span class="lineNum">     265 </span>            :     d = ((byte*)&amp;x)[0];
<span class="lineNum">     266 </span>            :   #endif
<span class="lineNum">     267 </span>            : 
<span class="lineNum">     268 </span>            :     return ((bc-&gt;s0[a] + bc-&gt;s1[b]) ^ bc-&gt;s2[c] ) + bc-&gt;s3[d];
<span class="lineNum">     269 </span>            : }
<span class="lineNum">     270 </span>            : #endif
<span class="lineNum">     271 </span>            : 
<span class="lineNum">     272 </span>            : #ifdef BIG_ENDIAN_HOST
<span class="lineNum">     273 </span>            :   #define F(x) ((( s0[((byte*)&amp;x)[0]] + s1[((byte*)&amp;x)[1]])      \
<span class="lineNum">     274 </span>            :                    ^ s2[((byte*)&amp;x)[2]]) + s3[((byte*)&amp;x)[3]] )
<span class="lineNum">     275 </span>            : #else
<span class="lineNum">     276 </span>            :   #define F(x) ((( s0[((byte*)&amp;x)[3]] + s1[((byte*)&amp;x)[2]])      \
<span class="lineNum">     277 </span>            :                    ^ s2[((byte*)&amp;x)[1]]) + s3[((byte*)&amp;x)[0]] )
<span class="lineNum">     278 </span>            : #endif
<span class="lineNum">     279 </span>            : #define R(l,r,i)  do { l ^= p[i]; r ^= F(l); } while(0)
<a name="280"><span class="lineNum">     280 </span>            : </a>
<span class="lineNum">     281 </span>            : static void
<span class="lineNum">     282 </span><span class="lineNoCov">          0 : burn_stack (int bytes)</span>
<span class="lineNum">     283 </span>            : {
<span class="lineNum">     284 </span>            :     char buf[64];
<span class="lineNum">     285 </span>            :     
<span class="lineNum">     286 </span><span class="lineNoCov">          0 :     memset (buf, 0, sizeof buf);</span>
<span class="lineNum">     287 </span><span class="lineNoCov">          0 :     bytes -= sizeof buf;</span>
<span class="lineNum">     288 </span><span class="lineNoCov">          0 :     if (bytes &gt; 0)</span>
<span class="lineNum">     289 </span><span class="lineNoCov">          0 :         burn_stack (bytes);</span>
<span class="lineNum">     290 </span><span class="lineNoCov">          0 : }</span>
<span class="lineNum">     291 </span>            : 
<a name="292"><span class="lineNum">     292 </span>            : </a>
<span class="lineNum">     293 </span>            : static void
<span class="lineNum">     294 </span><span class="lineNoCov">          0 : do_encrypt(  BLOWFISH_context *bc, u32 *ret_xl, u32 *ret_xr )</span>
<span class="lineNum">     295 </span>            : {
<span class="lineNum">     296 </span>            :   #if BLOWFISH_ROUNDS == 16
<span class="lineNum">     297 </span>            :     u32 xl, xr, *s0, *s1, *s2, *s3, *p;
<span class="lineNum">     298 </span>            : 
<span class="lineNum">     299 </span><span class="lineNoCov">          0 :     xl = *ret_xl;</span>
<span class="lineNum">     300 </span><span class="lineNoCov">          0 :     xr = *ret_xr;</span>
<span class="lineNum">     301 </span><span class="lineNoCov">          0 :     p = bc-&gt;p;</span>
<span class="lineNum">     302 </span><span class="lineNoCov">          0 :     s0 = bc-&gt;s0;</span>
<span class="lineNum">     303 </span><span class="lineNoCov">          0 :     s1 = bc-&gt;s1;</span>
<span class="lineNum">     304 </span><span class="lineNoCov">          0 :     s2 = bc-&gt;s2;</span>
<span class="lineNum">     305 </span><span class="lineNoCov">          0 :     s3 = bc-&gt;s3;</span>
<span class="lineNum">     306 </span>            : 
<span class="lineNum">     307 </span><span class="lineNoCov">          0 :     R( xl, xr,  0);</span>
<span class="lineNum">     308 </span><span class="lineNoCov">          0 :     R( xr, xl,  1);</span>
<span class="lineNum">     309 </span><span class="lineNoCov">          0 :     R( xl, xr,  2);</span>
<span class="lineNum">     310 </span><span class="lineNoCov">          0 :     R( xr, xl,  3);</span>
<span class="lineNum">     311 </span><span class="lineNoCov">          0 :     R( xl, xr,  4);</span>
<span class="lineNum">     312 </span><span class="lineNoCov">          0 :     R( xr, xl,  5);</span>
<span class="lineNum">     313 </span><span class="lineNoCov">          0 :     R( xl, xr,  6);</span>
<span class="lineNum">     314 </span><span class="lineNoCov">          0 :     R( xr, xl,  7);</span>
<span class="lineNum">     315 </span><span class="lineNoCov">          0 :     R( xl, xr,  8);</span>
<span class="lineNum">     316 </span><span class="lineNoCov">          0 :     R( xr, xl,  9);</span>
<span class="lineNum">     317 </span><span class="lineNoCov">          0 :     R( xl, xr, 10);</span>
<span class="lineNum">     318 </span><span class="lineNoCov">          0 :     R( xr, xl, 11);</span>
<span class="lineNum">     319 </span><span class="lineNoCov">          0 :     R( xl, xr, 12);</span>
<span class="lineNum">     320 </span><span class="lineNoCov">          0 :     R( xr, xl, 13);</span>
<span class="lineNum">     321 </span><span class="lineNoCov">          0 :     R( xl, xr, 14);</span>
<span class="lineNum">     322 </span><span class="lineNoCov">          0 :     R( xr, xl, 15);</span>
<span class="lineNum">     323 </span>            : 
<span class="lineNum">     324 </span><span class="lineNoCov">          0 :     xl ^= p[BLOWFISH_ROUNDS];</span>
<span class="lineNum">     325 </span><span class="lineNoCov">          0 :     xr ^= p[BLOWFISH_ROUNDS+1];</span>
<span class="lineNum">     326 </span>            : 
<span class="lineNum">     327 </span><span class="lineNoCov">          0 :     *ret_xl = xr;</span>
<span class="lineNum">     328 </span><span class="lineNoCov">          0 :     *ret_xr = xl;</span>
<span class="lineNum">     329 </span>            : 
<span class="lineNum">     330 </span>            :   #else
<span class="lineNum">     331 </span>            :     u32 xl, xr, temp, *p;
<span class="lineNum">     332 </span>            :     int i;
<span class="lineNum">     333 </span>            : 
<span class="lineNum">     334 </span>            :     xl = *ret_xl;
<span class="lineNum">     335 </span>            :     xr = *ret_xr;
<span class="lineNum">     336 </span>            :     p = bc-&gt;p;
<span class="lineNum">     337 </span>            : 
<span class="lineNum">     338 </span>            :     for(i=0; i &lt; BLOWFISH_ROUNDS; i++ ) {
<span class="lineNum">     339 </span>            :         xl ^= p[i];
<span class="lineNum">     340 </span>            :         xr ^= function_F(bc, xl);
<span class="lineNum">     341 </span>            :         temp = xl;
<span class="lineNum">     342 </span>            :         xl = xr;
<span class="lineNum">     343 </span>            :         xr = temp;
<span class="lineNum">     344 </span>            :     }
<span class="lineNum">     345 </span>            :     temp = xl;
<span class="lineNum">     346 </span>            :     xl = xr;
<span class="lineNum">     347 </span>            :     xr = temp;
<span class="lineNum">     348 </span>            : 
<span class="lineNum">     349 </span>            :     xr ^= p[BLOWFISH_ROUNDS];
<span class="lineNum">     350 </span>            :     xl ^= p[BLOWFISH_ROUNDS+1];
<span class="lineNum">     351 </span>            : 
<span class="lineNum">     352 </span>            :     *ret_xl = xl;
<span class="lineNum">     353 </span>            :     *ret_xr = xr;
<span class="lineNum">     354 </span>            :   #endif
<span class="lineNum">     355 </span><span class="lineNoCov">          0 : }</span>
<span class="lineNum">     356 </span>            : 
<a name="357"><span class="lineNum">     357 </span>            : </a>
<span class="lineNum">     358 </span>            : static void
<span class="lineNum">     359 </span><span class="lineNoCov">          0 : decrypt(  BLOWFISH_context *bc, u32 *ret_xl, u32 *ret_xr )</span>
<span class="lineNum">     360 </span>            : {
<span class="lineNum">     361 </span>            :   #if BLOWFISH_ROUNDS == 16
<span class="lineNum">     362 </span>            :     u32 xl, xr, *s0, *s1, *s2, *s3, *p;
<span class="lineNum">     363 </span>            : 
<span class="lineNum">     364 </span><span class="lineNoCov">          0 :     xl = *ret_xl;</span>
<span class="lineNum">     365 </span><span class="lineNoCov">          0 :     xr = *ret_xr;</span>
<span class="lineNum">     366 </span><span class="lineNoCov">          0 :     p = bc-&gt;p;</span>
<span class="lineNum">     367 </span><span class="lineNoCov">          0 :     s0 = bc-&gt;s0;</span>
<span class="lineNum">     368 </span><span class="lineNoCov">          0 :     s1 = bc-&gt;s1;</span>
<span class="lineNum">     369 </span><span class="lineNoCov">          0 :     s2 = bc-&gt;s2;</span>
<span class="lineNum">     370 </span><span class="lineNoCov">          0 :     s3 = bc-&gt;s3;</span>
<span class="lineNum">     371 </span>            : 
<span class="lineNum">     372 </span><span class="lineNoCov">          0 :     R( xl, xr, 17);</span>
<span class="lineNum">     373 </span><span class="lineNoCov">          0 :     R( xr, xl, 16);</span>
<span class="lineNum">     374 </span><span class="lineNoCov">          0 :     R( xl, xr, 15);</span>
<span class="lineNum">     375 </span><span class="lineNoCov">          0 :     R( xr, xl, 14);</span>
<span class="lineNum">     376 </span><span class="lineNoCov">          0 :     R( xl, xr, 13);</span>
<span class="lineNum">     377 </span><span class="lineNoCov">          0 :     R( xr, xl, 12);</span>
<span class="lineNum">     378 </span><span class="lineNoCov">          0 :     R( xl, xr, 11);</span>
<span class="lineNum">     379 </span><span class="lineNoCov">          0 :     R( xr, xl, 10);</span>
<span class="lineNum">     380 </span><span class="lineNoCov">          0 :     R( xl, xr,  9);</span>
<span class="lineNum">     381 </span><span class="lineNoCov">          0 :     R( xr, xl,  8);</span>
<span class="lineNum">     382 </span><span class="lineNoCov">          0 :     R( xl, xr,  7);</span>
<span class="lineNum">     383 </span><span class="lineNoCov">          0 :     R( xr, xl,  6);</span>
<span class="lineNum">     384 </span><span class="lineNoCov">          0 :     R( xl, xr,  5);</span>
<span class="lineNum">     385 </span><span class="lineNoCov">          0 :     R( xr, xl,  4);</span>
<span class="lineNum">     386 </span><span class="lineNoCov">          0 :     R( xl, xr,  3);</span>
<span class="lineNum">     387 </span><span class="lineNoCov">          0 :     R( xr, xl,  2);</span>
<span class="lineNum">     388 </span>            : 
<span class="lineNum">     389 </span><span class="lineNoCov">          0 :     xl ^= p[1];</span>
<span class="lineNum">     390 </span><span class="lineNoCov">          0 :     xr ^= p[0];</span>
<span class="lineNum">     391 </span>            : 
<span class="lineNum">     392 </span><span class="lineNoCov">          0 :     *ret_xl = xr;</span>
<span class="lineNum">     393 </span><span class="lineNoCov">          0 :     *ret_xr = xl;</span>
<span class="lineNum">     394 </span>            : 
<span class="lineNum">     395 </span>            :   #else
<span class="lineNum">     396 </span>            :     u32 xl, xr, temp, *p;
<span class="lineNum">     397 </span>            :     int i;
<span class="lineNum">     398 </span>            : 
<span class="lineNum">     399 </span>            :     xl = *ret_xl;
<span class="lineNum">     400 </span>            :     xr = *ret_xr;
<span class="lineNum">     401 </span>            :     p = bc-&gt;p;
<span class="lineNum">     402 </span>            : 
<span class="lineNum">     403 </span>            :     for(i=BLOWFISH_ROUNDS+1; i &gt; 1; i-- ) {
<span class="lineNum">     404 </span>            :         xl ^= p[i];
<span class="lineNum">     405 </span>            :         xr ^= function_F(bc, xl);
<span class="lineNum">     406 </span>            :         temp = xl;
<span class="lineNum">     407 </span>            :         xl = xr;
<span class="lineNum">     408 </span>            :         xr = temp;
<span class="lineNum">     409 </span>            :     }
<span class="lineNum">     410 </span>            : 
<span class="lineNum">     411 </span>            :     temp = xl;
<span class="lineNum">     412 </span>            :     xl = xr;
<span class="lineNum">     413 </span>            :     xr = temp;
<span class="lineNum">     414 </span>            : 
<span class="lineNum">     415 </span>            :     xr ^= p[1];
<span class="lineNum">     416 </span>            :     xl ^= p[0];
<span class="lineNum">     417 </span>            : 
<span class="lineNum">     418 </span>            :     *ret_xl = xl;
<span class="lineNum">     419 </span>            :     *ret_xr = xr;
<span class="lineNum">     420 </span>            :   #endif
<span class="lineNum">     421 </span><span class="lineNoCov">          0 : }</span>
<span class="lineNum">     422 </span>            : 
<span class="lineNum">     423 </span>            : #undef F
<span class="lineNum">     424 </span>            : #undef R
<a name="425"><span class="lineNum">     425 </span>            : </a>
<span class="lineNum">     426 </span>            : static void
<span class="lineNum">     427 </span><span class="lineNoCov">          0 : do_encrypt_block( BLOWFISH_context *bc, byte *outbuf, byte *inbuf )</span>
<span class="lineNum">     428 </span>            : {
<span class="lineNum">     429 </span>            :     u32 d1, d2;
<span class="lineNum">     430 </span>            : 
<span class="lineNum">     431 </span><span class="lineNoCov">          0 :     d1 = inbuf[0] &lt;&lt; 24 | inbuf[1] &lt;&lt; 16 | inbuf[2] &lt;&lt; 8 | inbuf[3];</span>
<span class="lineNum">     432 </span><span class="lineNoCov">          0 :     d2 = inbuf[4] &lt;&lt; 24 | inbuf[5] &lt;&lt; 16 | inbuf[6] &lt;&lt; 8 | inbuf[7];</span>
<span class="lineNum">     433 </span><span class="lineNoCov">          0 :     do_encrypt( bc, &amp;d1, &amp;d2 );</span>
<span class="lineNum">     434 </span><span class="lineNoCov">          0 :     outbuf[0] = (d1 &gt;&gt; 24) &amp; 0xff;</span>
<span class="lineNum">     435 </span><span class="lineNoCov">          0 :     outbuf[1] = (d1 &gt;&gt; 16) &amp; 0xff;</span>
<span class="lineNum">     436 </span><span class="lineNoCov">          0 :     outbuf[2] = (d1 &gt;&gt;    8) &amp; 0xff;</span>
<span class="lineNum">     437 </span><span class="lineNoCov">          0 :     outbuf[3] =  d1        &amp; 0xff;</span>
<span class="lineNum">     438 </span><span class="lineNoCov">          0 :     outbuf[4] = (d2 &gt;&gt; 24) &amp; 0xff;</span>
<span class="lineNum">     439 </span><span class="lineNoCov">          0 :     outbuf[5] = (d2 &gt;&gt; 16) &amp; 0xff;</span>
<span class="lineNum">     440 </span><span class="lineNoCov">          0 :     outbuf[6] = (d2 &gt;&gt;    8) &amp; 0xff;</span>
<span class="lineNum">     441 </span><span class="lineNoCov">          0 :     outbuf[7] =  d2        &amp; 0xff;</span>
<span class="lineNum">     442 </span><span class="lineNoCov">          0 : }</span>
<a name="443"><span class="lineNum">     443 </span>            : </a>
<span class="lineNum">     444 </span>            : static void
<span class="lineNum">     445 </span><span class="lineNoCov">          0 : encrypt_block( BLOWFISH_context *bc, byte *outbuf, byte *inbuf )</span>
<span class="lineNum">     446 </span>            : {
<span class="lineNum">     447 </span><span class="lineNoCov">          0 :     do_encrypt_block (bc, outbuf, inbuf);</span>
<span class="lineNum">     448 </span><span class="lineNoCov">          0 :     burn_stack (64);</span>
<span class="lineNum">     449 </span><span class="lineNoCov">          0 : }</span>
<a name="450"><span class="lineNum">     450 </span>            : </a>
<span class="lineNum">     451 </span>            : static void
<span class="lineNum">     452 </span><span class="lineNoCov">          0 : do_decrypt_block( BLOWFISH_context *bc, byte *outbuf, byte *inbuf )</span>
<span class="lineNum">     453 </span>            : {
<span class="lineNum">     454 </span>            :     u32 d1, d2;
<span class="lineNum">     455 </span>            : 
<span class="lineNum">     456 </span><span class="lineNoCov">          0 :     d1 = inbuf[0] &lt;&lt; 24 | inbuf[1] &lt;&lt; 16 | inbuf[2] &lt;&lt; 8 | inbuf[3];</span>
<span class="lineNum">     457 </span><span class="lineNoCov">          0 :     d2 = inbuf[4] &lt;&lt; 24 | inbuf[5] &lt;&lt; 16 | inbuf[6] &lt;&lt; 8 | inbuf[7];</span>
<span class="lineNum">     458 </span><span class="lineNoCov">          0 :     decrypt( bc, &amp;d1, &amp;d2 );</span>
<span class="lineNum">     459 </span><span class="lineNoCov">          0 :     outbuf[0] = (d1 &gt;&gt; 24) &amp; 0xff;</span>
<span class="lineNum">     460 </span><span class="lineNoCov">          0 :     outbuf[1] = (d1 &gt;&gt; 16) &amp; 0xff;</span>
<span class="lineNum">     461 </span><span class="lineNoCov">          0 :     outbuf[2] = (d1 &gt;&gt;    8) &amp; 0xff;</span>
<span class="lineNum">     462 </span><span class="lineNoCov">          0 :     outbuf[3] =  d1        &amp; 0xff;</span>
<span class="lineNum">     463 </span><span class="lineNoCov">          0 :     outbuf[4] = (d2 &gt;&gt; 24) &amp; 0xff;</span>
<span class="lineNum">     464 </span><span class="lineNoCov">          0 :     outbuf[5] = (d2 &gt;&gt; 16) &amp; 0xff;</span>
<span class="lineNum">     465 </span><span class="lineNoCov">          0 :     outbuf[6] = (d2 &gt;&gt;    8) &amp; 0xff;</span>
<span class="lineNum">     466 </span><span class="lineNoCov">          0 :     outbuf[7] =  d2        &amp; 0xff;</span>
<span class="lineNum">     467 </span><span class="lineNoCov">          0 : }</span>
<a name="468"><span class="lineNum">     468 </span>            : </a>
<span class="lineNum">     469 </span>            : static void
<span class="lineNum">     470 </span><span class="lineNoCov">          0 : decrypt_block( BLOWFISH_context *bc, byte *outbuf, byte *inbuf )</span>
<span class="lineNum">     471 </span>            : {
<span class="lineNum">     472 </span><span class="lineNoCov">          0 :     do_decrypt_block (bc, outbuf, inbuf);</span>
<span class="lineNum">     473 </span><span class="lineNoCov">          0 :     burn_stack (64);</span>
<span class="lineNum">     474 </span><span class="lineNoCov">          0 : }</span>
<span class="lineNum">     475 </span>            : 
<a name="476"><span class="lineNum">     476 </span>            : </a>
<span class="lineNum">     477 </span>            : static const char*
<span class="lineNum">     478 </span><span class="lineNoCov">          0 : selftest(void)</span>
<span class="lineNum">     479 </span>            : {
<span class="lineNum">     480 </span>            :     BLOWFISH_context c;
<span class="lineNum">     481 </span><span class="lineNoCov">          0 :     byte plain[] = &quot;BLOWFISH&quot;;</span>
<span class="lineNum">     482 </span>            :     byte buffer[8];
<span class="lineNum">     483 </span><span class="lineNoCov">          0 :     byte plain3[] = { 0xFE, 0xDC, 0xBA, 0x98, 0x76, 0x54, 0x32, 0x10 };</span>
<span class="lineNum">     484 </span><span class="lineNoCov">          0 :     byte key3[] = { 0x41, 0x79, 0x6E, 0xA0, 0x52, 0x61, 0x6E, 0xE4 };</span>
<span class="lineNum">     485 </span><span class="lineNoCov">          0 :     byte cipher3[] = { 0xE1, 0x13, 0xF4, 0x10, 0x2C, 0xFC, 0xCE, 0x43 };</span>
<span class="lineNum">     486 </span>            : 
<span class="lineNum">     487 </span><span class="lineNoCov">          0 :     bf_setkey( &amp;c, &quot;abcdefghijklmnopqrstuvwxyz&quot;, 26 );</span>
<span class="lineNum">     488 </span><span class="lineNoCov">          0 :     encrypt_block( &amp;c, buffer, plain );</span>
<span class="lineNum">     489 </span><span class="lineNoCov">          0 :     if( memcmp( buffer, &quot;\x32\x4E\xD0\xFE\xF4\x13\xA2\x03&quot;, 8 ) )</span>
<span class="lineNum">     490 </span><span class="lineNoCov">          0 :         return &quot;Blowfish selftest failed (1).&quot;;</span>
<span class="lineNum">     491 </span><span class="lineNoCov">          0 :     decrypt_block( &amp;c, buffer, buffer );</span>
<span class="lineNum">     492 </span><span class="lineNoCov">          0 :     if( memcmp( buffer, plain, 8 ) )</span>
<span class="lineNum">     493 </span><span class="lineNoCov">          0 :         return &quot;Blowfish selftest failed (2).&quot;;</span>
<span class="lineNum">     494 </span>            : 
<span class="lineNum">     495 </span><span class="lineNoCov">          0 :     bf_setkey( &amp;c, key3, 8 );</span>
<span class="lineNum">     496 </span><span class="lineNoCov">          0 :     encrypt_block( &amp;c, buffer, plain3 );</span>
<span class="lineNum">     497 </span><span class="lineNoCov">          0 :     if( memcmp( buffer, cipher3, 8 ) )</span>
<span class="lineNum">     498 </span><span class="lineNoCov">          0 :         return &quot;Blowfish selftest failed (3).&quot;;</span>
<span class="lineNum">     499 </span><span class="lineNoCov">          0 :     decrypt_block( &amp;c, buffer, buffer );</span>
<span class="lineNum">     500 </span><span class="lineNoCov">          0 :     if( memcmp( buffer, plain3, 8 ) )</span>
<span class="lineNum">     501 </span><span class="lineNoCov">          0 :         return &quot;Blowfish selftest failed (4).&quot;;</span>
<span class="lineNum">     502 </span><span class="lineNoCov">          0 :     return NULL;</span>
<span class="lineNum">     503 </span>            : }
<span class="lineNum">     504 </span>            : 
<span class="lineNum">     505 </span>            : 
<a name="506"><span class="lineNum">     506 </span>            : </a>
<span class="lineNum">     507 </span>            : static int
<span class="lineNum">     508 </span><span class="lineNoCov">          0 : do_bf_setkey( BLOWFISH_context *c, byte *key, unsigned keylen )</span>
<span class="lineNum">     509 </span>            : {
<span class="lineNum">     510 </span>            :     int i, j;
<span class="lineNum">     511 </span>            :     u32 data, datal, datar;
<span class="lineNum">     512 </span>            :     static int initialized;
<span class="lineNum">     513 </span>            :     static const char *selftest_failed;
<span class="lineNum">     514 </span>            : 
<span class="lineNum">     515 </span><span class="lineNoCov">          0 :     if( !initialized ) {</span>
<span class="lineNum">     516 </span><span class="lineNoCov">          0 :         initialized = 1;</span>
<span class="lineNum">     517 </span><span class="lineNoCov">          0 :         selftest_failed = selftest();</span>
<span class="lineNum">     518 </span><span class="lineNoCov">          0 :         if( selftest_failed )</span>
<span class="lineNum">     519 </span><span class="lineNoCov">          0 :             fprintf(stderr,&quot;%s\n&quot;, selftest_failed );</span>
<span class="lineNum">     520 </span>            :     }
<span class="lineNum">     521 </span><span class="lineNoCov">          0 :     if( selftest_failed )</span>
<span class="lineNum">     522 </span><span class="lineNoCov">          0 :         return G10ERR_SELFTEST_FAILED;</span>
<span class="lineNum">     523 </span>            : 
<span class="lineNum">     524 </span><span class="lineNoCov">          0 :     for(i=0; i &lt; BLOWFISH_ROUNDS+2; i++ )</span>
<span class="lineNum">     525 </span><span class="lineNoCov">          0 :         c-&gt;p[i] = ps[i];</span>
<span class="lineNum">     526 </span><span class="lineNoCov">          0 :     for(i=0; i &lt; 256; i++ ) {</span>
<span class="lineNum">     527 </span><span class="lineNoCov">          0 :         c-&gt;s0[i] = ks0[i];</span>
<span class="lineNum">     528 </span><span class="lineNoCov">          0 :         c-&gt;s1[i] = ks1[i];</span>
<span class="lineNum">     529 </span><span class="lineNoCov">          0 :         c-&gt;s2[i] = ks2[i];</span>
<span class="lineNum">     530 </span><span class="lineNoCov">          0 :         c-&gt;s3[i] = ks3[i];</span>
<span class="lineNum">     531 </span>            :     }
<span class="lineNum">     532 </span>            : 
<span class="lineNum">     533 </span><span class="lineNoCov">          0 :     for(i=j=0; i &lt; BLOWFISH_ROUNDS+2; i++ ) {</span>
<span class="lineNum">     534 </span>            :       #ifdef BIG_ENDIAN_HOST
<span class="lineNum">     535 </span>            :         ((byte*)&amp;data)[0] = key[j];
<span class="lineNum">     536 </span>            :         ((byte*)&amp;data)[1] = key[(j+1)%keylen];
<span class="lineNum">     537 </span>            :         ((byte*)&amp;data)[2] = key[(j+2)%keylen];
<span class="lineNum">     538 </span>            :         ((byte*)&amp;data)[3] = key[(j+3)%keylen];
<span class="lineNum">     539 </span>            :       #else
<span class="lineNum">     540 </span><span class="lineNoCov">          0 :         ((byte*)&amp;data)[3] = key[j];</span>
<span class="lineNum">     541 </span><span class="lineNoCov">          0 :         ((byte*)&amp;data)[2] = key[(j+1)%keylen];</span>
<span class="lineNum">     542 </span><span class="lineNoCov">          0 :         ((byte*)&amp;data)[1] = key[(j+2)%keylen];</span>
<span class="lineNum">     543 </span><span class="lineNoCov">          0 :         ((byte*)&amp;data)[0] = key[(j+3)%keylen];</span>
<span class="lineNum">     544 </span>            :       #endif
<span class="lineNum">     545 </span><span class="lineNoCov">          0 :         c-&gt;p[i] ^= data;</span>
<span class="lineNum">     546 </span><span class="lineNoCov">          0 :         j = (j+4) % keylen;</span>
<span class="lineNum">     547 </span>            :     }
<span class="lineNum">     548 </span>            : 
<span class="lineNum">     549 </span><span class="lineNoCov">          0 :     datal = datar = 0;</span>
<span class="lineNum">     550 </span><span class="lineNoCov">          0 :     for(i=0; i &lt; BLOWFISH_ROUNDS+2; i += 2 ) {</span>
<span class="lineNum">     551 </span><span class="lineNoCov">          0 :         do_encrypt( c, &amp;datal, &amp;datar );</span>
<span class="lineNum">     552 </span><span class="lineNoCov">          0 :         c-&gt;p[i]   = datal;</span>
<span class="lineNum">     553 </span><span class="lineNoCov">          0 :         c-&gt;p[i+1] = datar;</span>
<span class="lineNum">     554 </span>            :     }
<span class="lineNum">     555 </span><span class="lineNoCov">          0 :     for(i=0; i &lt; 256; i += 2 )       {</span>
<span class="lineNum">     556 </span><span class="lineNoCov">          0 :         do_encrypt( c, &amp;datal, &amp;datar );</span>
<span class="lineNum">     557 </span><span class="lineNoCov">          0 :         c-&gt;s0[i]   = datal;</span>
<span class="lineNum">     558 </span><span class="lineNoCov">          0 :         c-&gt;s0[i+1] = datar;</span>
<span class="lineNum">     559 </span>            :     }
<span class="lineNum">     560 </span><span class="lineNoCov">          0 :     for(i=0; i &lt; 256; i += 2 )       {</span>
<span class="lineNum">     561 </span><span class="lineNoCov">          0 :         do_encrypt( c, &amp;datal, &amp;datar );</span>
<span class="lineNum">     562 </span><span class="lineNoCov">          0 :         c-&gt;s1[i]   = datal;</span>
<span class="lineNum">     563 </span><span class="lineNoCov">          0 :         c-&gt;s1[i+1] = datar;</span>
<span class="lineNum">     564 </span>            :     }
<span class="lineNum">     565 </span><span class="lineNoCov">          0 :     for(i=0; i &lt; 256; i += 2 )       {</span>
<span class="lineNum">     566 </span><span class="lineNoCov">          0 :         do_encrypt( c, &amp;datal, &amp;datar );</span>
<span class="lineNum">     567 </span><span class="lineNoCov">          0 :         c-&gt;s2[i]   = datal;</span>
<span class="lineNum">     568 </span><span class="lineNoCov">          0 :         c-&gt;s2[i+1] = datar;</span>
<span class="lineNum">     569 </span>            :     }
<span class="lineNum">     570 </span><span class="lineNoCov">          0 :     for(i=0; i &lt; 256; i += 2 )       {</span>
<span class="lineNum">     571 </span><span class="lineNoCov">          0 :         do_encrypt( c, &amp;datal, &amp;datar );</span>
<span class="lineNum">     572 </span><span class="lineNoCov">          0 :         c-&gt;s3[i]   = datal;</span>
<span class="lineNum">     573 </span><span class="lineNoCov">          0 :         c-&gt;s3[i+1] = datar;</span>
<span class="lineNum">     574 </span>            :     }
<span class="lineNum">     575 </span>            : 
<span class="lineNum">     576 </span>            : 
<span class="lineNum">     577 </span>            :     /* Check for weak key.  A weak key is a key in which a value in */
<span class="lineNum">     578 </span>            :     /* the P-array (here c) occurs more than once per table.        */
<span class="lineNum">     579 </span><span class="lineNoCov">          0 :     for(i=0; i &lt; 255; i++ ) {</span>
<span class="lineNum">     580 </span><span class="lineNoCov">          0 :         for( j=i+1; j &lt; 256; j++) {</span>
<span class="lineNum">     581 </span><span class="lineNoCov">          0 :             if( (c-&gt;s0[i] == c-&gt;s0[j]) || (c-&gt;s1[i] == c-&gt;s1[j]) ||</span>
<span class="lineNum">     582 </span><span class="lineNoCov">          0 :                 (c-&gt;s2[i] == c-&gt;s2[j]) || (c-&gt;s3[i] == c-&gt;s3[j]) )</span>
<span class="lineNum">     583 </span><span class="lineNoCov">          0 :                 return G10ERR_WEAK_KEY;</span>
<span class="lineNum">     584 </span>            :         }
<span class="lineNum">     585 </span>            :     }
<span class="lineNum">     586 </span>            : 
<span class="lineNum">     587 </span><span class="lineNoCov">          0 :     return 0;</span>
<span class="lineNum">     588 </span>            : }
<a name="589"><span class="lineNum">     589 </span>            : </a>
<span class="lineNum">     590 </span>            : static int
<span class="lineNum">     591 </span><span class="lineNoCov">          0 : bf_setkey( BLOWFISH_context *c, byte *key, unsigned keylen )</span>
<span class="lineNum">     592 </span>            : {
<span class="lineNum">     593 </span><span class="lineNoCov">          0 :     int rc = do_bf_setkey (c, key, keylen);</span>
<span class="lineNum">     594 </span><span class="lineNoCov">          0 :     burn_stack (64);</span>
<span class="lineNum">     595 </span><span class="lineNoCov">          0 :     return rc;</span>
<span class="lineNum">     596 </span>            : }
<span class="lineNum">     597 </span>            : 
<span class="lineNum">     598 </span>            : /****************
<span class="lineNum">     599 </span>            :  * Return some information about the algorithm.  We need algo here to
<span class="lineNum">     600 </span>            :  * distinguish different flavors of the algorithm.
<span class="lineNum">     601 </span>            :  * Returns: A pointer to string describing the algorithm or NULL if
<span class="lineNum">     602 </span>            :  *          the ALGO is invalid.
<a name="603"><span class="lineNum">     603 </span>            :  */</a>
<span class="lineNum">     604 </span>            : const char *
<span class="lineNum">     605 </span><span class="lineNoCov">          0 : blowfish_get_info( int algo, size_t *keylen,</span>
<span class="lineNum">     606 </span>            :                    size_t *blocksize, size_t *contextsize,
<span class="lineNum">     607 </span>            :                    int  (**r_setkey)( void *c, byte *key, unsigned keylen ),
<span class="lineNum">     608 </span>            :                    void (**r_encrypt)( void *c, byte *outbuf, byte *inbuf ),
<span class="lineNum">     609 </span>            :                    void (**r_decrypt)( void *c, byte *outbuf, byte *inbuf )
<span class="lineNum">     610 </span>            :                  )
<span class="lineNum">     611 </span>            : {
<span class="lineNum">     612 </span><span class="lineNoCov">          0 :     *keylen = 128;</span>
<span class="lineNum">     613 </span><span class="lineNoCov">          0 :     *blocksize = BLOWFISH_BLOCKSIZE;</span>
<span class="lineNum">     614 </span><span class="lineNoCov">          0 :     *contextsize = sizeof(BLOWFISH_context);</span>
<span class="lineNum">     615 </span><span class="lineNoCov">          0 :     *(int  (**)(BLOWFISH_context*, byte*, unsigned))r_setkey</span>
<span class="lineNum">     616 </span><span class="lineNoCov">          0 :                                                         = bf_setkey;</span>
<span class="lineNum">     617 </span><span class="lineNoCov">          0 :     *(void (**)(BLOWFISH_context*, byte*, byte*))r_encrypt</span>
<span class="lineNum">     618 </span><span class="lineNoCov">          0 :                                                         = encrypt_block;</span>
<span class="lineNum">     619 </span><span class="lineNoCov">          0 :     *(void (**)(BLOWFISH_context*, byte*, byte*))r_decrypt</span>
<span class="lineNum">     620 </span><span class="lineNoCov">          0 :                                                         = decrypt_block;</span>
<span class="lineNum">     621 </span>            : 
<span class="lineNum">     622 </span><span class="lineNoCov">          0 :     if( algo == CIPHER_ALGO_BLOWFISH )</span>
<span class="lineNum">     623 </span><span class="lineNoCov">          0 :         return &quot;BLOWFISH&quot;;</span>
<span class="lineNum">     624 </span><span class="lineNoCov">          0 :     return NULL;</span>
<span class="lineNum">     625 </span>            : }
<span class="lineNum">     626 </span>            : 
</pre>
      </td>
    </tr>
  </table>
  <br>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="ruler"><img src="../glass.png" width=3 height=3 alt=""></td></tr>
    <tr><td class="versionInfo">Generated by: <a href="http://ltp.sourceforge.net/coverage/lcov.php" target="_parent">LCOV version 1.10</a></td></tr>
  </table>
  <br>

</body>
</html>
